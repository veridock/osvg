# Example app configuration for Caddy
# This would be auto-generated by the deployment script

app.example.com {
    # Logging
    log {
        output file /osvg/logs/app-example-access.log
        format json
    }
    
    # Root directory
    root * /osvg/apps/example-app/public
    
    # PHP-FPM
    php_fastcgi unix//var/run/php/php8.2-fpm.sock {
        root /osvg/apps/example-app/public
    }
    
    # Security headers
    header {
        X-Content-Type-Options nosniff
        X-Frame-Options SAMEORIGIN
        X-XSS-Protection "1; mode=block"
        Referrer-Policy strict-origin-when-cross-origin
    }
    
    # Handle .php files
    try_files {path} {path}/index.php?{query}
    
    # Disable directory listing
    file_server {
        hide .git
        browse
    }
    
    # Enable compression
    encode gzip
    
    # Handle errors
    handle_errors {
        @404 {
            expression {http.error.status_code} == 404
        }
        rewrite @404 /404.html
        file_server
    }
}
